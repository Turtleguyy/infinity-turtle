(function(){var t;t=function(){function t(t,i){this.data=t,this._options=$.extend({},this.defaults,i),this.view=$(this._options.container),this.promise=$.Deferred(),this._page=0,this.buildLoader(),this.loadNextPage(),this.data.length>this._options.pageSize&&this.view.on("scroll",$.proxy(this,"_onContainerScroll"))}return t.prototype.defaults={container:"body",loaderColor:"#ddddff",loaderSymbol:"infinity",loaderURL:!1,loaderWidth:"2px",pageSize:2,scrollDelay:50},t.prototype.buildLoader=function(){var t;return t="border-width: "+this._options.loaderWidth+";",this._loader=function(){switch(this._options.loaderSymbol){case"infinity":return this._buildInfinityLoader(t);default:return this._buildCircleLoader(t)}}.call(this)},t.prototype._buildInfinityLoader=function(t){var i,o,e;return i="border-color: "+this._options.loaderColor+";",o="class='infinite-loader "+this._options.loaderSymbol+"'",e="<div "+o+" style='"+i+"'>\n  <div class='left' style='"+t+"' />\n  <div class='right' style='"+t+"' />\n</div>",$(e)},t.prototype._buildCircleLoader=function(t){var i,o,e,r;return o="border-top-color: "+this._options.loaderColor+";",i="border-left-color: "+this._options.loaderColor+";",r="style='"+t+" "+o+" "+i+"'",e="class='infinite-loader "+this._options.loaderSymbol+"'",$("<div "+e+" "+r+" />")},t.prototype.checkScrollPosition=function(){var t,i;return t=this.view.find(":last-child"),i=t.offset().top+t.height(),i-=this.view.offset().top,console.log(i,this.view.height()),i<=this.view.height()?(this.view.append(this._loader),this.view.off("scroll"),this.loadNextPage()):void 0},t.prototype.loadNextPage=function(){var t,i;return this._page+=1,this._loader.remove(),t=this._options.pageSize*(this._page-1),i=this.data.slice(t,this._options.pageSize+t),i.length<this._options.pageSize?this.promise.resolve(i):(this.promise.notify(i),this.view.on("scroll",$.proxy(this,"_onContainerScroll")))},t.prototype._onContainerScroll=function(){return clearTimeout(this._timeout),this._timeout=setTimeout(function(t){return function(){return t.checkScrollPosition()}}(this),this._options.scrollDelay)},t}(),window.InfinityTurtle=t}).call(this);
